<!DOCTYPE html>
<html lang="zh-CN" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SubConvert Ultra - è®¢é˜…è½¬æ¢</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css" rel="stylesheet">
    
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        dark: {
                            bg: '#0f172a',
                            card: '#1e293b',
                            input: '#334155',
                            border: '#475569'
                        },
                        brand: {
                            500: '#6366f1', // Indigo
                            600: '#4f46e5'
                        }
                    }
                }
            }
        }
    </script>
    <style>
        /* éšè—æ»šåŠ¨æ¡ä½†ä¿ç•™åŠŸèƒ½ */
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        
        /* é€‰ä¸­çŠ¶æ€çš„æ ·å¼ */
        .config-group-label {
            color: #94a3b8;
            font-size: 0.75rem;
            font-weight: 700;
            padding: 8px 12px;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
    </style>
</head>
<body class="bg-gray-100 dark:bg-dark-bg text-gray-800 dark:text-gray-200 transition-colors duration-300 min-h-screen flex flex-col">

<div id="app" class="flex-grow container mx-auto px-4 py-8 max-w-5xl">
    
    <div class="flex justify-between items-center mb-8">
        <div class="flex items-center gap-3">
            <div class="w-10 h-10 rounded-xl bg-brand-600 flex items-center justify-center shadow-lg shadow-brand-500/20">
                <i class="ri-command-fill text-white text-xl"></i>
            </div>
            <h1 class="text-2xl font-bold tracking-tight">SubConvert <span class="text-brand-500">Ultra</span></h1>
        </div>
        
        <button @click="toggleTheme" class="p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors">
            <i v-if="isDark" class="ri-moon-clear-line text-xl text-yellow-400"></i>
            <i v-else class="ri-sun-line text-xl text-orange-500"></i>
        </button>
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-12 gap-6">
        
        <div class="lg:col-span-8 space-y-6">
            
            <div class="bg-white dark:bg-dark-card rounded-2xl p-1 shadow-sm border border-gray-200 dark:border-dark-border">
                <div class="p-4 border-b border-gray-100 dark:border-dark-border flex justify-between items-center">
                    <label class="font-semibold text-sm flex items-center gap-2">
                        <i class="ri-links-line text-brand-500"></i> è®¢é˜…é“¾æ¥
                    </label>
                    <span class="text-xs text-gray-400">æ”¯æŒå¤šè¡Œè¾“å…¥æˆ–ç”¨ | åˆ†éš”</span>
                </div>
                <textarea 
                    v-model="form.url"
                    class="w-full h-32 bg-transparent p-4 outline-none text-sm resize-none placeholder-gray-400 dark:placeholder-gray-600"
                    placeholder="è¯·ç²˜è´´æœºåœºè®¢é˜…é“¾æ¥..."
                ></textarea>
            </div>

            <div class="bg-white dark:bg-dark-card rounded-2xl shadow-sm border border-gray-200 dark:border-dark-border overflow-hidden">
                <div class="grid grid-cols-1 md:grid-cols-2 divide-y md:divide-y-0 md:divide-x border-gray-200 dark:border-dark-border divide-gray-200 dark:divide-dark-border">
                    
                    <div class="p-5">
                        <label class="block text-xs font-bold text-gray-500 uppercase mb-3 tracking-wider">å®¢æˆ·ç«¯ (Target)</label>
                        <div class="relative">
                            <select v-model="form.target" class="w-full bg-gray-50 dark:bg-dark-input border border-gray-200 dark:border-dark-border rounded-lg px-4 py-3 outline-none focus:border-brand-500 transition-colors appearance-none cursor-pointer text-sm font-medium">
                                <option value="clash">Clash</option>
                                <option value="clashr">ClashR</option>
                                <option value="v2ray">V2Ray</option>
                                <option value="surge&ver=4">Surge 4+</option>
                                <option value="loon">Loon</option>
                                <option value="ss">Shadowsocks</option>
                                <option value="ssr">ShadowsocksR</option>
                                <option value="surfboard">Surfboard</option>
                                <option value="quanx">Quantumult X</option>
                                <option value="singbox">Sing-Box</option>
                            </select>
                            <i class="ri-arrow-down-s-line absolute right-3 top-3.5 text-gray-400 pointer-events-none"></i>
                        </div>
                    </div>

                    <div class="p-5">
                        <label class="block text-xs font-bold text-gray-500 uppercase mb-3 tracking-wider">åç«¯æœåŠ¡ (Backend)</label>
                        <div class="relative">
                            <select v-model="form.backend" class="w-full bg-gray-50 dark:bg-dark-input border border-gray-200 dark:border-dark-border rounded-lg px-4 py-3 outline-none focus:border-brand-500 transition-colors appearance-none cursor-pointer text-sm font-medium">
                                <option v-for="(url, label) in backendOptions" :key="url" :value="url">
                                    {{ label }}
                                </option>
                            </select>
                            <i class="ri-arrow-down-s-line absolute right-3 top-3.5 text-gray-400 pointer-events-none"></i>
                        </div>
                    </div>
                </div>

                <div class="p-5 border-t border-gray-200 dark:border-dark-border">
                    <label class="block text-xs font-bold text-gray-500 uppercase mb-3 tracking-wider">è¿œç¨‹é…ç½® (Remote Config)</label>
                    <div class="relative">
                        <select v-model="form.config" class="w-full bg-gray-50 dark:bg-dark-input border border-gray-200 dark:border-dark-border rounded-lg px-4 py-3 outline-none focus:border-brand-500 transition-colors appearance-none cursor-pointer text-sm font-medium font-mono">
                            <option value="">ä¸ä½¿ç”¨é…ç½® (é»˜è®¤)</option>
                            <template v-for="(group, index) in remoteConfig" :key="index">
                                <optgroup :label="group.label">
                                    <option v-for="item in group.options" :key="item.value" :value="item.value">
                                        {{ item.label }}
                                    </option>
                                </optgroup>
                            </template>
                        </select>
                        <i class="ri-arrow-down-s-line absolute right-3 top-3.5 text-gray-400 pointer-events-none"></i>
                    </div>
                </div>
            </div>

            <button 
                @click="generate"
                class="w-full py-4 bg-brand-600 hover:bg-brand-500 active:scale-[0.99] text-white font-bold rounded-xl shadow-lg shadow-brand-500/20 transition-all flex items-center justify-center gap-2"
            >
                <i class="ri-flashlight-fill"></i> ç”Ÿæˆè®¢é˜…é“¾æ¥
            </button>
            
            <div v-if="resultUrl" class="bg-white dark:bg-dark-card rounded-2xl p-6 shadow-sm border border-brand-500/30 animate-fade-in-up">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="font-bold text-lg">ç”ŸæˆæˆåŠŸ</h3>
                    <span class="text-xs bg-green-500/10 text-green-500 px-2 py-1 rounded">200 OK</span>
                </div>
                <div class="bg-gray-50 dark:bg-[#0f1115] p-4 rounded-lg border border-gray-200 dark:border-gray-800 mb-4 break-all font-mono text-xs text-gray-600 dark:text-gray-400 selection:bg-brand-500 selection:text-white">
                    {{ resultUrl }}
                </div>
                <div class="grid grid-cols-2 gap-3">
                    <button @click="copyUrl" class="py-2.5 px-4 rounded-lg bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 font-medium text-sm transition-colors">
                        <i class="ri-file-copy-line mr-1"></i> å¤åˆ¶é“¾æ¥
                    </button>
                    <a :href="resultUrl" target="_blank" class="py-2.5 px-4 rounded-lg bg-brand-600/10 text-brand-600 hover:bg-brand-600/20 font-medium text-sm text-center transition-colors">
                        ä¸€é”®å¯¼å…¥ / æ‰“å¼€
                    </a>
                </div>
            </div>

        </div>

        <div class="lg:col-span-4 space-y-6">
            <div class="bg-white dark:bg-dark-card rounded-2xl p-6 shadow-sm border border-gray-200 dark:border-dark-border h-full">
                <h3 class="font-bold text-gray-900 dark:text-white mb-6 flex items-center gap-2">
                    <i class="ri-settings-4-line text-brand-500"></i> é«˜çº§é€‰é¡¹
                </h3>
                
                <div class="space-y-4">
                    <div v-for="(val, key) in options" :key="key" class="flex items-center justify-between group">
                        <span class="text-sm text-gray-600 dark:text-gray-400 font-medium">{{ optionLabels[key] }}</span>
                        <label class="relative inline-flex items-center cursor-pointer">
                            <input type="checkbox" v-model="form[key]" class="sr-only peer">
                            <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-brand-600"></div>
                        </label>
                    </div>
                    
                    <div class="pt-4 border-t border-gray-200 dark:border-dark-border space-y-4">
                        <div>
                            <label class="block text-xs font-medium text-gray-500 mb-1.5">åŒ…å«èŠ‚ç‚¹ (æ­£åˆ™)</label>
                            <input v-model="form.include" type="text" placeholder="ä¾‹å¦‚: é¦™æ¸¯|HK|HongKong" class="w-full bg-gray-50 dark:bg-dark-input border border-gray-200 dark:border-dark-border rounded-lg px-3 py-2 text-xs outline-none focus:border-brand-500">
                        </div>
                        <div>
                            <label class="block text-xs font-medium text-gray-500 mb-1.5">æ’é™¤èŠ‚ç‚¹ (æ­£åˆ™)</label>
                            <input v-model="form.exclude" type="text" placeholder="ä¾‹å¦‚: å‰©ä½™æµé‡|è¿‡æœŸæ—¶é—´" class="w-full bg-gray-50 dark:bg-dark-input border border-gray-200 dark:border-dark-border rounded-lg px-3 py-2 text-xs outline-none focus:border-brand-500">
                        </div>
                        <div>
                            <label class="block text-xs font-medium text-gray-500 mb-1.5">è‡ªå®šä¹‰æ–‡ä»¶å</label>
                            <input v-model="form.filename" type="text" placeholder="é»˜è®¤ä¸º subconverter" class="w-full bg-gray-50 dark:bg-dark-input border border-gray-200 dark:border-dark-border rounded-lg px-3 py-2 text-xs outline-none focus:border-brand-500">
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    const { createApp, ref, reactive, onMounted } = Vue

    createApp({
        setup() {
            const isDark = ref(true) // é»˜è®¤å¼€å¯æš—é»‘æ¨¡å¼

            // è¡¨å•æ•°æ®
            const form = reactive({
                url: '',
                target: 'clash',
                backend: 'https://api.v1.mk/sub?', // é»˜è®¤åç«¯
                config: '',
                emoji: true,
                udp: false,
                tfo: false,
                scv: false,
                fdn: false,
                sort: false,
                nodeList: false,
                include: '',
                exclude: '',
                filename: ''
            })

            const resultUrl = ref('')

            // é€‰é¡¹æ ‡ç­¾æ˜ å°„
            const optionLabels = {
                emoji: 'Emoji è¡¨æƒ…',
                udp: 'å¯ç”¨ UDP',
                tfo: 'å¯ç”¨ TFO',
                scv: 'è·³è¿‡è¯ä¹¦éªŒè¯',
                fdn: 'è¿‡æ»¤éæ³•èŠ‚ç‚¹',
                sort: 'èŠ‚ç‚¹æ’åº',
                nodeList: 'è¾“å‡º Node List'
            }
            
            // ä»…ç”¨äºéå†æ˜¾ç¤ºå¼€å…³
            const options = {
                emoji: true, udp: false, tfo: false, scv: false, fdn: false, sort: false, nodeList: false
            }

            // =========================================================================
            // ğŸ”´ å…³é”®åŒºåŸŸï¼šåç«¯ä¸é…ç½®åˆ—è¡¨
            // ä½ å¯ä»¥æ‰“å¼€ sub-web-modify çš„ Subconverter.vueï¼Œæœç´¢ "backendOptions" å’Œ "remoteConfig"
            // å°†é‚£ä¸ªæ–‡ä»¶é‡Œçš„æ•°æ®å¯¹åº”æ›¿æ¢åˆ°ä¸‹é¢ã€‚
            // =========================================================================

            // 1. åç«¯åœ°å€åˆ—è¡¨ (å¯¹åº” Subconverter.vue ä¸­çš„ backendOptions)
            // æˆ‘è¿™é‡Œé¢„ç½®äº† sub-web-modify ç¤¾åŒºç‰ˆæœ€å¸¸ç”¨çš„åˆ—è¡¨
            const backendOptions = {
                "è‚¥ç¾Šå¢å¼ºå‹åç«¯ [v1.mk]": "https://api.v1.mk/sub?",
                "å“äº‘æä¾›åç«¯ [id9.cc]": "https://sub.id9.cc/sub?",
                "Nameless 13 [nameless13.com]": "https://www.nameless13.com/sub?",
                "Subconverter ä½œè€… [sub.xeton.dev]": "https://sub.xeton.dev/sub?",
                "ã¤ã¤-å¤šåœ°é˜²å¤±è” [tsutsu.one]": "https://api.tsutsu.one/sub?",
                "Dler [dler.io]": "https://api.dler.io/sub?",
                "æœ¬åœ°å±€åŸŸç½‘ [127.0.0.1:25500]": "http://127.0.0.1:25500/sub?"
            }

            // 2. è¿œç¨‹é…ç½®åˆ—è¡¨ (å¯¹åº” Subconverter.vue ä¸­çš„ remoteConfig)
            // æ³¨æ„ï¼šsub-web-modify ä½¿ç”¨çš„æ˜¯åˆ†ç»„ç»“æ„ [{label: 'xx', options: [...]}, ...]
            // ä¸‹é¢æ˜¯æ ‡å‡† ACL4SSR ç»“æ„ç¤ºä¾‹ï¼Œå¦‚æœä½ çš„é¡¹ç›®ä¸­å®šä¹‰ä¸åŒï¼Œè¯·æ•´å—æ›¿æ¢ã€‚
            const remoteConfig = [
                {
                    label: "ACL4SSR",
                    options: [
                        { label: "ACL4SSR_Online é»˜è®¤ç‰ˆ", value: "https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/config/ACL4SSR_Online.ini" },
                        { label: "ACL4SSR_Online_AdblockPlus å»å¹¿å‘Š", value: "https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/config/ACL4SSR_Online_AdblockPlus.ini" },
                        { label: "ACL4SSR_Online_Mini ç²¾ç®€ç‰ˆ", value: "https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/config/ACL4SSR_Online_Mini.ini" },
                        { label: "ACL4SSR_Online_Full å…¨åˆ†ç»„", value: "https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/config/ACL4SSR_Online_Full.ini" }
                    ]
                },
                {
                    label: "å…¶ä»–çƒ­é—¨",
                    options: [
                        { label: "åŸºç¡€è½¬æ¢ (ä»…è½¬æ¢æ ¼å¼)", value: "" },
                        { label: "CyberNode è§„åˆ™", value: "https://raw.githubusercontent.com/CyberNode/CyberNode/master/Clash/config/CyberNode_Online.ini" }
                    ]
                }
            ]

            // =========================================================================
            // ğŸ”´ ç»“æŸå…³é”®åŒºåŸŸ
            // =========================================================================

            const toggleTheme = () => {
                isDark.value = !isDark.value
                if (isDark.value) {
                    document.documentElement.classList.add('dark')
                } else {
                    document.documentElement.classList.remove('dark')
                }
            }

            const generate = () => {
                if (!form.url) {
                    alert('è¯·è¾“å…¥è®¢é˜…é“¾æ¥')
                    return
                }

                const params = new URLSearchParams()
                params.append('target', form.target)
                params.append('url', form.url)
                params.append('emoji', form.emoji)
                params.append('udp', form.udp)
                params.append('tfo', form.tfo)
                params.append('scv', form.scv)
                params.append('fdn', form.fdn)
                params.append('sort', form.sort)
                params.append('list', form.nodeList)
                
                if (form.config) params.append('config', form.config)
                if (form.include) params.append('include', form.include)
                if (form.exclude) params.append('exclude', form.exclude)
                if (form.filename) params.append('filename', form.filename)

                resultUrl.value = form.backend + params.toString()
            }

            const copyUrl = () => {
                navigator.clipboard.writeText(resultUrl.value).then(() => {
                    alert('å¤åˆ¶æˆåŠŸ')
                })
            }

            return {
                isDark,
                toggleTheme,
                form,
                backendOptions,
                remoteConfig,
                options,
                optionLabels,
                generate,
                resultUrl,
                copyUrl
            }
        }
    }).mount('#app')
</script>
</body>
</html>
